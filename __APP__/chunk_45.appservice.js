__wxCodeSpace__.batchAddCompiledTemplate(function(G,R,D,Q,gdc,X,Y,Z,RG={}){var P=RG.P||function(a){return typeof a==='function'?a:()=>{}};return {'pages/driver/binding/binding':(()=>{var H={};var S;var I=(P)=>{if(!S)S=Object.assign({},H);return S[P]};H[""]=(R,C,D,U)=>{var L=R.c,M=R.m,O=R.r,A={"currentCar":new Array(3)},K=U===true,c=(C)=>{},b=(C,T,E)=>{E("van-cell",{},(N,C)=>{if(C||K||Z(U.currentCar,"name"))O(N,"title",X(D.currentCar).name);A["currentCar"][0]=(D,E,T)=>{O(N,"title",X(D.currentCar).name);E(N)};if(C)O(N,"value","");if(C)O(N,"clickable","true");if(C||K||Z(U.currentCar,"id"))R.d(N,"id",X(D.currentCar).id);A["currentCar"][1]=(D,E,T)=>{R.d(N,"id",X(D.currentCar).id);E(N)};if(C||K||Z(U.currentCar,"name"))R.d(N,"name",X(D.currentCar).name);A["currentCar"][2]=(D,E,T)=>{R.d(N,"name",X(D.currentCar).name);E(N)};if(C)R.v(N,"click","unbindCar",!1,!1,!1,!1)},c)},e,h=(C,i,j,k,l,m,T,E)=>{var o=(C)=>{},n=(C,T,E)=>{E("van-cell",{},(N,C)=>{if(C||K||Z(k,"name"))O(N,"title",X(i).name);if(C)O(N,"value","");if(C)O(N,"clickable","true");if(C||K||Z(k,"id"))R.d(N,"id",X(i).id);if(C||K||Z(k,"name"))R.d(N,"name",X(i).name);if(C)R.v(N,"click","bindCar",!1,!1,!1,!1)},o)};E("view",{},(N,C)=>{},n)},g=(C,T,E,B,F)=>{F(D.carList,"key",U?U.carList:undefined,[0,"carList"],h)},j=(C)=>{},i=(C,T,E)=>{E("van-empty",{},(N,C)=>{if(C)O(N,"image","search");if(C)O(N,"description","暂无可选车辆")},j)},f=(C,T,E)=>{if(e===1){E("view",{},(N,C)=>{},g)}else{E("view",{},(N,C)=>{},i)}},d=(C,T,E,B)=>{e=X(D.carList).length>0?1:0;B(e,f)},k=(C)=>{},l=(C)=>{},a=(C,T,E)=>{E("van-cell-group",{},(N,C)=>{if(C)O(N,"title","当前绑定")},b);E("van-cell-group",{},(N,C)=>{if(C)O(N,"title","可选车辆")},d);E("van-toast",{},(N,C)=>{if(C)R.i(N,"van-toast")},k);E("van-dialog",{},(N,C)=>{if(C)R.i(N,"van-dialog")},l)};;return {C:a,B:A}};return Object.assign(function(R){return H[R]},{_:H})})(),}});;__wxRoute = "pages/driver/binding/binding";__wxRouteBegin = true;__wxAppCurrentFile__="pages/driver/binding/binding.js";define("pages/driver/binding/binding.js",function(require,module,exports,window,document,frames,self,location,navigator,localStorage,history,Caches,screen,alert,confirm,prompt,XMLHttpRequest,WebSocket,Reporter,webkit,WeixinJSCore){
"use strict";var t=require("../../../utils/client.js"),a=n(require("../../../component/vant-weapp/dist/toast/toast")),e=n(require("../../../component/vant-weapp/dist/dialog/dialog"));function n(t){return t&&t.__esModule?t:{default:t}}var r=getApp();Page({data:{currentCar:{id:"",name:"未绑定车辆"},carList:[]},onLoad:function(t){this.setData({taskId:t.taskId}),this._getCarInfo(r.globalData.driver.id)},_getCarInfo:function(a){var e=this;(0,t.client)({method:"POST",data:{userId:a},url:"/driver/getCarInfo"}).then((function(t){if("6666"==t.meta.statusCode){var a=t.data.carInfo;e.setData({currentCar:a.currentCar?a.currentCar:{id:"",name:"未绑定车辆"},carList:a.carList?a.carList:[]})}}))},unbindCar:function(n){if(this.data.taskId)a.default.fail("执行任务时仅允许换绑");else{var i=n.currentTarget.dataset.id,d=n.currentTarget.dataset.name;i&&e.default.confirm({title:"解绑车辆",message:"确认解绑车辆"+d+"吗？"}).then((function(){(0,t.client)({method:"POST",data:{userId:r.globalData.driver.id,id:i,name:d},url:"/driver/unbindCar"}).then((function(t){"6666"==t.meta.statusCode&&wx.navigateBack()}))})).catch((function(){}))}},bindCar:function(a){var n=this,i=a.currentTarget.dataset.id,d=a.currentTarget.dataset.name;e.default.confirm({title:"绑定车辆",message:"确认绑定车辆"+d+"吗？"}).then((function(){(0,t.client)({method:"POST",data:{userId:r.globalData.driver.id,id:i,name:d,taskId:n.data.taskId},url:"/driver/bindCar"}).then((function(t){"6666"==t.meta.statusCode&&wx.navigateBack()}))})).catch((function(){}))},onReady:function(){},onShow:function(){},onHide:function(){},onUnload:function(){},onPullDownRefresh:function(){this._getCarInfo(r.globalData.driver.id)},onReachBottom:function(){},onShareAppMessage:function(){}});
},{isPage:true,isComponent:true,currentFile:'pages/driver/binding/binding.js'});require("pages/driver/binding/binding.js");